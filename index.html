<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>IP Change Checker</title>

<style>
  body {
    font-family: Arial, sans-serif;
    padding: 20px;
  }

  button {
    padding: 10px 20px;
    font-size: 16px;
    cursor: pointer;
  }

  #box {
    display: inline-block;
    width: 30px;
    height: 30px;
    margin-left: 15px;
    border: 2px solid #ccc;
    vertical-align: middle;
    background: #eee;
  }
</style>
</head>
<body>

<button id="changeBtn">Change IP</button>
<div id="box"></div>

<script>
const CHANGE_IP_URL = 'https://i.fxdx.in/actionlinks/do/changeip/YTbojipTQnuowNvn2MkNoA';
const IP_API = 'https://api.ipify.org?format=json';

const btn = document.getElementById('changeBtn');
const box = document.getElementById('box');

let oldIP = null;

async function getIP() {
  const res = await fetch(IP_API);
  const data = await res.json();
  return data.ip;
}

async function checkIPLoop() {
  const newIP = await getIP();

  if (newIP !== oldIP) {
    box.style.background = 'green';
    btn.disabled = false;
  } else {
    box.style.background = 'red';
    setTimeout(checkIPLoop, 10000); // retry after 10 sec
  }
}

btn.addEventListener('click', async () => {
  btn.disabled = true;
  box.style.background = '#eee';

  // 1️⃣ Store current IP
  oldIP = await getIP();

  // 2️⃣ Trigger IP change in background
  fetch(CHANGE_IP_URL).catch(() => {});

  // 3️⃣ Wait 25 seconds then start checking
  setTimeout(checkIPLoop, 25000);
});
</script>

</body>
</html>
